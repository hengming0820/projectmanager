# 🔍 临时调试步骤

## 第一步：强制刷新并查看控制台

**操作：**

```
1. 按 Ctrl+Shift+R 强制刷新页面
2. 按 F12 打开控制台
3. 点击"开始编辑"按钮
```

**查看日志：**

你应该看到以下日志：

```
✅ [TextBus] 编辑器实例已创建
🔍 [TextBus] 检查工具栏元素...
🔍 [TextBus] 编辑器配置: {...}
🔍 [TextBus] 使用的插件: ['StaticToolbarPlugin']
🔍 [TextBus] 容器内总元素数: XXX
🔍 [TextBus] 找到的工具栏元素: X [...]
```

## 第二步：根据日志判断

### 情况 A: 找到了工具栏（数量 > 0）

**日志显示：**

```
🔍 [TextBus] 找到的工具栏元素: 1 [div.textbus-static-toolbar]
✅ [TextBus] 已强制显示工具栏: textbus-static-toolbar
```

**说明：** 工具栏存在，应该已经自动显示了

**操作：**

- 检查页面顶部是否出现灰色的工具栏
- 如果还是看不见，截图页面给我看

### 情况 B: 没找到工具栏（数量 = 0）

**日志显示：**

```
❌ [TextBus] 未找到任何工具栏元素！
💡 [TextBus] 容器HTML: <div data-textbus-view="VIEW_CONTAINER">...
```

**说明：** 工具栏插件没有生成HTML

**操作：** 继续下面的步骤 3

## 第三步：如果没有工具栏，创建临时工具栏

在控制台运行以下代码：

```javascript
// 创建临时工具栏
const editor = document.querySelector('[data-textbus-view="VIEW_DOCUMENT"]')
if (editor) {
  // 创建工具栏容器
  const toolbar = document.createElement('div')
  toolbar.id = 'temp-toolbar'
  toolbar.style.cssText = `
    position: sticky;
    top: 0;
    z-index: 1000;
    background: #f9fafb;
    border-bottom: 1px solid #e5e7eb;
    padding: 8px 12px;
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
  `

  // 工具按钮配置
  const tools = [
    { label: 'B', title: '粗体', command: 'bold' },
    { label: 'I', title: '斜体', command: 'italic' },
    { label: 'U', title: '下划线', command: 'underline' },
    { label: 'S', title: '删除线', command: 'strikeThrough' },
    { label: '列表', title: '无序列表', command: 'insertUnorderedList' },
    { label: '编号', title: '有序列表', command: 'insertOrderedList' },
    { label: '撤销', title: '撤销', command: 'undo' },
    { label: '重做', title: '重做', command: 'redo' }
  ]

  // 创建按钮
  tools.forEach((tool) => {
    const btn = document.createElement('button')
    btn.textContent = tool.label
    btn.title = tool.title
    btn.style.cssText = `
      padding: 6px 12px;
      background: white;
      border: 1px solid #d1d5db;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      font-weight: ${tool.command === 'bold' ? 'bold' : 'normal'};
      font-style: ${tool.command === 'italic' ? 'italic' : 'normal'};
      text-decoration: ${tool.command === 'underline' ? 'underline' : 'none'};
    `

    btn.onmouseover = () => {
      btn.style.background = '#f3f4f6'
    }
    btn.onmouseout = () => {
      btn.style.background = 'white'
    }

    btn.onclick = () => {
      editor.focus()
      document.execCommand(tool.command, false, null)
    }

    toolbar.appendChild(btn)
  })

  // 插入工具栏
  const container = editor.parentElement
  if (container) {
    container.insertBefore(toolbar, editor)
    console.log('✅ 临时工具栏已创建')
  }
}
```

**预期效果：**

- 页面顶部出现一排按钮
- 包括：B、I、U、S、列表、编号、撤销、重做
- 选中文字后点击按钮可以格式化

## 第四步：测试临时工具栏

1. 在编辑器中输入文字
2. 选中文字
3. 点击 **B** 按钮
4. 文字应该变粗

## 第五步：告诉我结果

请截图并告诉我：

1. **控制台日志**

   - 特别是这几条：
     - `使用的插件`
     - `找到的工具栏元素`
     - `容器HTML`

2. **临时工具栏是否工作？**

   - 是否出现了？
   - 点击按钮是否有效？

3. **你想要哪种方案？**
   - A: 继续调试 XNote 的工具栏
   - B: 使用这个临时工具栏（更简单，功能基本够用）
   - C: 完全自定义一个工具栏（最稳定，我来写）

## 📊 三种方案对比

| 方案            | 优点     | 缺点           |
| --------------- | -------- | -------------- |
| A. XNote工具栏  | 功能完整 | 显示问题难解决 |
| B. 临时工具栏   | 快速可用 | 功能简单       |
| C. 自定义工具栏 | 完全可控 | 需要开发时间   |

## 💡 我的建议

如果临时工具栏能满足需求，建议先用着，至少能正常工作。

之后我们可以：

1. 升级 XNote 版本
2. 或者开发一个完整的自定义工具栏
3. 或者换用其他编辑器（如 Tiptap、Quill）

---

**现在请先刷新页面，查看控制台日志，然后告诉我结果！** 🔍
