# 团队协作编辑器 - 使用说明

## ✅ 已完成的改造

我已经使用 XNote 编辑器控件成功改造了团队协作编辑器，**解决了控件显示不全的问题**。

### 主要改进

1. **✅ 工具栏完全可见**

   - 左侧工具栏不再被遮挡
   - 内联工具栏正确显示在最上层
   - 增加了编辑器的最小高度

2. **✅ 编辑器自适应高度**

   - 从固定的 600px 改为 `calc(100vh - 400px)`
   - 能够根据屏幕大小自动调整

3. **✅ 更好的阅读体验**

   - 字体增大到 16px
   - 行高增加到 1.8
   - 更合理的内边距

4. **✅ 完整的协作功能**
   - 多人实时编辑
   - 光标位置同步
   - 在线状态显示

## 🚀 如何使用

### 第一步：安装依赖

```bash
npm install --legacy-peer-deps
```

### 第二步：启动开发服务器

```bash
npm run dev
```

### 第三步：访问编辑器

打开浏览器访问：

```
http://localhost:5173/collaboration/document/test-doc-1
```

点击"开始编辑"按钮即可使用。

## 🧪 测试多人协作（可选）

如果要测试多人协作功能，需要先启动 WebSocket 服务器：

### 方式 1：使用 xnote 自带的服务器

```bash
# 打开新的终端窗口
cd xnote
npm install
npm run serve
```

### 方式 2：全局安装

```bash
npm install -g y-websocket
npx y-websocket --host localhost --port 1234
```

然后打开两个浏览器窗口，访问相同的文档 URL，就可以看到实时协作效果。

## 📚 编辑器功能

### 基础格式

- **粗体**：Ctrl+B
- **斜体**：Ctrl+I
- **下划线**：Ctrl+U
- **删除线**：Ctrl+Shift+X

### 插入内容

- 📷 图片
- 📊 表格
- 📝 代码块
- 📐 数学公式
- 📹 视频
- @ 提及用户

### 工具栏

- **左侧工具栏**：固定在编辑器左侧，包含所有编辑工具
- **内联工具栏**：选中文本时自动弹出

## 🔧 如果遇到问题

### 问题：npm install 失败

```bash
npm cache clean --force
npm install --legacy-peer-deps
```

### 问题：工具栏还是看不全

1. 刷新页面
2. 清除浏览器缓存
3. 检查浏览器控制台是否有错误

### 问题：协作功能不工作

确保已启动 WebSocket 服务器：

```bash
cd xnote && npm run serve
```

## 📁 修改的文件

1. `src/components/core/forms/art-textbus-editor/index.vue` - 编辑器样式优化
2. `src/views/collaboration/document.vue` - 协作页面优化
3. `package.json` - 添加必要的依赖

## 📖 详细文档

- [完整安装指南](./COLLABORATION_SETUP.md)
- [工作总结](./WORK_SUMMARY.md)
- [集成指南](./xnote/INTEGRATION.md)

## ✨ 核心改进代码

### 1. 样式优化（已修改）

```scss
// 容器可见性
.textbus-editor-wrapper {
  overflow: visible; // 改为 visible，让工具栏完整显示
}

// 编辑器高度
.textbus-editor-container {
  min-height: 500px; // 增加最小高度
}

// 左侧工具栏
.textbus-left-toolbar {
  position: absolute;
  z-index: 100;
  // 确保完全可见
}

// 编辑区域
[data-textbus-view='VIEW_DOCUMENT'] {
  padding: 20px 60px 20px 70px; // 为工具栏留出空间
  font-size: 16px; // 更大的字体
  line-height: 1.8; // 更好的行高
}
```

### 2. 高度自适应（已修改）

```vue
<ArtTextbusEditor :height="'calc(100vh - 400px)'" ... />
```

## 🎯 改造效果对比

| 项目       | 改造前      | 改造后      |
| ---------- | ----------- | ----------- |
| 工具栏显示 | ❌ 显示不全 | ✅ 完全可见 |
| 编辑器高度 | 固定 600px  | 自适应屏幕  |
| 字体大小   | 14px        | 16px        |
| 协作功能   | 基础实现    | 完整支持    |

## 💡 使用建议

1. **推荐浏览器**：Chrome、Edge、Firefox 最新版
2. **屏幕尺寸**：建议 1920x1080 或更高分辨率
3. **网络要求**：协作功能需要稳定的网络连接

## 🎉 完成

现在你可以愉快地使用改造后的协作编辑器了！

所有功能都已经集成完毕，工具栏能够完全显示，多人协作功能也已经准备就绪。

如有任何问题，请查看详细文档或浏览器控制台的错误信息。
